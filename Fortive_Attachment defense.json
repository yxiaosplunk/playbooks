{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Uncategorized",
    "coa": {
        "data": {
            "description": "",
            "edges": [
                {
                    "id": "port_0_to_port_20",
                    "sourceNode": "0",
                    "sourcePort": "0_out",
                    "targetNode": "20",
                    "targetPort": "20_in"
                },
                {
                    "id": "port_20_to_port_21",
                    "sourceNode": "20",
                    "sourcePort": "20_out",
                    "targetNode": "21",
                    "targetPort": "21_in"
                },
                {
                    "id": "port_21_to_port_9",
                    "sourceNode": "21",
                    "sourcePort": "21_out",
                    "targetNode": "9",
                    "targetPort": "9_in"
                },
                {
                    "id": "port_18_to_port_22",
                    "sourceNode": "18",
                    "sourcePort": "18_out",
                    "targetNode": "22",
                    "targetPort": "22_in"
                },
                {
                    "id": "port_21_to_port_8",
                    "sourceNode": "21",
                    "sourcePort": "21_out",
                    "targetNode": "8",
                    "targetPort": "8_in"
                },
                {
                    "conditions": [
                        {
                            "index": 0
                        }
                    ],
                    "id": "port_25_to_port_18",
                    "sourceNode": "25",
                    "sourcePort": "25_out",
                    "targetNode": "18",
                    "targetPort": "18_in"
                },
                {
                    "id": "port_26_to_port_25",
                    "sourceNode": "26",
                    "sourcePort": "26_out",
                    "targetNode": "25",
                    "targetPort": "25_in"
                },
                {
                    "id": "port_8_to_port_26",
                    "sourceNode": "8",
                    "sourcePort": "8_out",
                    "targetNode": "26",
                    "targetPort": "26_in"
                },
                {
                    "id": "port_9_to_port_26",
                    "sourceNode": "9",
                    "sourcePort": "9_out",
                    "targetNode": "26",
                    "targetPort": "26_in"
                },
                {
                    "id": "port_22_to_port_23",
                    "sourceNode": "22",
                    "sourcePort": "22_out",
                    "targetNode": "23",
                    "targetPort": "23_in"
                },
                {
                    "id": "port_30_to_port_31",
                    "sourceNode": "30",
                    "sourcePort": "30_out",
                    "targetNode": "31",
                    "targetPort": "31_in"
                },
                {
                    "id": "port_31_to_port_32",
                    "sourceNode": "31",
                    "sourcePort": "31_out",
                    "targetNode": "32",
                    "targetPort": "32_in"
                },
                {
                    "id": "port_23_to_port_34",
                    "sourceNode": "23",
                    "sourcePort": "23_out",
                    "targetNode": "34",
                    "targetPort": "34_in"
                },
                {
                    "id": "port_35_to_port_37",
                    "sourceNode": "35",
                    "sourcePort": "35_out",
                    "targetNode": "37",
                    "targetPort": "37_in"
                },
                {
                    "id": "port_34_to_port_6",
                    "sourceNode": "34",
                    "sourcePort": "34_out",
                    "targetNode": "6",
                    "targetPort": "6_in"
                }
            ],
            "hash": "f34fb241649bd41f8a9a35cf16d1b8268f14d487",
            "nodes": {
                "0": {
                    "data": {
                        "advanced": {
                            "join": []
                        },
                        "functionName": "on_start",
                        "id": "0",
                        "type": "start"
                    },
                    "errors": {},
                    "id": "0",
                    "type": "start",
                    "warnings": {},
                    "x": 190,
                    "y": 7.999999999999616
                },
                "1": {
                    "data": {
                        "advanced": {
                            "join": []
                        },
                        "functionName": "on_finish",
                        "id": "1",
                        "type": "end"
                    },
                    "errors": {},
                    "id": "1",
                    "type": "end",
                    "warnings": {},
                    "x": 490,
                    "y": 7.999999999999616
                },
                "11": {
                    "data": {
                        "action": "send email",
                        "actionType": "generic",
                        "advanced": {
                            "join": []
                        },
                        "connector": "SMTP",
                        "connectorConfigs": [
                            "smtp_fqdn"
                        ],
                        "connectorId": "45bb6f37-4478-499b-b4a3-51ecfa62b78c",
                        "connectorVersion": "v1",
                        "functionId": 1,
                        "functionName": "send_email_1",
                        "id": "11",
                        "parameters": {
                            "body": "sender_and_recipient_address_user_validation:action_result.parameter.message",
                            "cc": "samir.shah@fortive.com",
                            "from": "no-reply@fortive.com",
                            "subject": "Test:Attachment_Defense-Alert",
                            "to": "sabarirajan.thangavel@ftvitservices.com"
                        },
                        "requiredParameters": [
                            {
                                "data_type": "string",
                                "field": "to"
                            },
                            {
                                "data_type": "string",
                                "field": "body"
                            }
                        ],
                        "type": "action"
                    },
                    "errors": {},
                    "id": "11",
                    "type": "action",
                    "warnings": {
                        "config": [
                            "Reconfigure invalid datapath."
                        ]
                    },
                    "x": 1130,
                    "y": 8
                },
                "18": {
                    "data": {
                        "advanced": {
                            "customName": "Sender and Recipient address user validation",
                            "customNameId": 0,
                            "join": []
                        },
                        "approver": {
                            "type": "user",
                            "value": "sabarirajan.thangavel@ftvitservices.com"
                        },
                        "customDatapaths": {
                            "artifacts": {
                                "artifact:*.cef.Recipient": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.Recipient",
                                    "value": "artifact:*.cef.Recipient"
                                }
                            }
                        },
                        "functionId": 2,
                        "functionName": "sender_and_recipient_address_user_validation",
                        "id": "18",
                        "message": "Hi SOC Team,\n\nPlease validate if any business communication between Sender and Recipient in Proofpoint. \n\nSender address:{0}\nRecipient address:{1}\n",
                        "parameters": [
                            "artifact:*.cef.sender",
                            "artifact:*.cef.Recipient"
                        ],
                        "responseTime": 15,
                        "responses": [
                            {
                                "responseOptions": [
                                    "Yes",
                                    "No"
                                ],
                                "responsePrompt": "Validate Sender address  is a legit?",
                                "responseType": "yes/no"
                            },
                            {
                                "responseOptions": [
                                    "Yes",
                                    "No"
                                ],
                                "responsePrompt": "Validate Recipient address  is a legit?",
                                "responseType": "yes/no"
                            }
                        ],
                        "type": "prompt"
                    },
                    "errors": {},
                    "id": "18",
                    "type": "prompt",
                    "warnings": {},
                    "x": 250,
                    "y": 952
                },
                "20": {
                    "data": {
                        "advanced": {
                            "customName": "Attachment_defense_description",
                            "customNameId": 1,
                            "join": []
                        },
                        "customDatapaths": {
                            "artifacts": {
                                "artifact:*.cef.Recipient": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.Recipient",
                                    "value": "artifact:*.cef.Recipient"
                                },
                                "artifact:*.cef.Threat_Infomap_Classification": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.Threat_Infomap_Classification",
                                    "value": "artifact:*.cef.Threat_Infomap_Classification"
                                },
                                "artifact:*.cef.Threat_MD5_hash": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.Threat_MD5_hash",
                                    "value": "artifact:*.cef.Threat_MD5_hash"
                                },
                                "artifact:*.cef.eventType": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.eventType",
                                    "value": "artifact:*.cef.eventType"
                                },
                                "artifact:*.cef.eventtype": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.eventtype",
                                    "value": "artifact:*.cef.eventtype"
                                },
                                "artifact:*.cef.sender": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.sender",
                                    "value": "artifact:*.cef.sender"
                                },
                                "artifact:*.cef.senderIP": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.senderIP",
                                    "value": "artifact:*.cef.senderIP"
                                },
                                "artifact:*.cef.subject": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.subject",
                                    "value": "artifact:*.cef.subject"
                                }
                            }
                        },
                        "functionId": 2,
                        "functionName": "attachment_defense_description_1",
                        "id": "20",
                        "parameters": [
                            "artifact:*.id",
                            "artifact:*.create_time",
                            "artifact:*.cef.eventType",
                            "artifact:*.cef.sender",
                            "artifact:*.cef.Recipient",
                            "artifact:*.cef.Threat_Infomap_Classification",
                            "artifact:*.cef.subject",
                            "artifact:*.cef.senderIP",
                            "artifact:*.cef.Threat_MD5_hash"
                        ],
                        "template": "Hi SOC Team,\n\nThis is a attachment defense Test alert triggered from SOAR.\n\nPlease take appropriate action on it:\n\ncontainer_id: {0}\n\ncreate_time:{1}\n\neventType:{2}\n\nsender:{3}\n\nRecipient:{4}\n\nThreat_Infomap_Classification:{5}\n\nSubject:{6}\n\nSenderIP:{7}\n\nThreat_MD5_hash:{8}\n",
                        "type": "format"
                    },
                    "errors": {},
                    "id": "20",
                    "type": "format",
                    "warnings": {},
                    "x": 170,
                    "y": 163.99999999999983
                },
                "21": {
                    "data": {
                        "action": "create ticket",
                        "actionType": "generic",
                        "advanced": {
                            "customName": "create_sir_ticket",
                            "customNameId": 0,
                            "join": []
                        },
                        "connector": "ServiceNow",
                        "connectorConfigs": [
                            "servicenowprod"
                        ],
                        "connectorId": "a590c3bc-ca41-4a0e-b063-8066ca868794",
                        "connectorVersion": "v1",
                        "functionId": 1,
                        "functionName": "create_sir_ticket",
                        "id": "21",
                        "parameters": {
                            "description": "attachment_defense_description_1:formatted_data",
                            "fields": "",
                            "short_description": "Test:Attachment_Defense_Alert:SOAR Testing",
                            "table": "sn_si_incident_import"
                        },
                        "requiredParameters": [
                            {
                                "data_type": "string",
                                "default": "incident",
                                "field": "table"
                            }
                        ],
                        "type": "action"
                    },
                    "errors": {},
                    "id": "21",
                    "type": "action",
                    "warnings": {},
                    "x": 170,
                    "y": 328
                },
                "22": {
                    "data": {
                        "advanced": {
                            "customName": "Risk_Score_Ip address and File reputation",
                            "customNameId": 0,
                            "join": []
                        },
                        "functionId": 3,
                        "functionName": "risk_score_ip_address_and_file_reputation",
                        "id": "22",
                        "parameters": [
                            "file_reputation:action_result.summary",
                            "ip_reputation:action_result.summary",
                            "sender_and_recipient_address_user_validation:action_result.summary.responses.0",
                            "sender_and_recipient_address_user_validation:action_result.summary.responses.1"
                        ],
                        "template": "Hi Team,\n\nPlease find the risk score for IP address and File reputation hash values from recorded future.\n\nfile_reputation Risk_Score:{0}\n\nip_reputation Risk_Score:{1}\n\nValidate Sender address  is a legit?: {2}\n\nValidate Recipient address  is a legit?:  {3}\n",
                        "type": "format"
                    },
                    "errors": {},
                    "id": "22",
                    "type": "format",
                    "warnings": {},
                    "x": 160,
                    "y": 1100
                },
                "23": {
                    "data": {
                        "action": "add work note",
                        "actionType": "generic",
                        "advanced": {
                            "customName": "Worknote Update",
                            "customNameId": 0,
                            "join": []
                        },
                        "connector": "ServiceNow",
                        "connectorConfigs": [
                            "servicenowprod"
                        ],
                        "connectorId": "a590c3bc-ca41-4a0e-b063-8066ca868794",
                        "connectorVersion": "v1",
                        "customDatapaths": {
                            "create_sir_ticket": {
                                "action_result.data.*.parameter.id": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "action_result.data.*.parameter.id",
                                    "value": "create_sir_ticket:action_result.data.*.parameter.id"
                                },
                                "action_result.data.*.sys_target_sys_id.value": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "action_result.data.*.sys_target_sys_id.value",
                                    "value": "create_sir_ticket:action_result.data.*.sys_target_sys_id.value"
                                }
                            }
                        },
                        "functionId": 1,
                        "functionName": "worknote_update",
                        "id": "23",
                        "parameters": {
                            "id": "create_sir_ticket:action_result.data.*.sys_target_sys_id.value",
                            "is_sys_id": true,
                            "table_name": "sn_si_incident",
                            "work_note": {
                                "functionId": 1,
                                "parameters": [
                                    "sender_and_recipient_address_user_validation:action_result.summary.responses.0",
                                    "sender_and_recipient_address_user_validation:action_result.summary.responses.1",
                                    "artifact:*.cef.opco"
                                ],
                                "template": "Please find the business communication information for sender and Recipient address from the SOC Team validation. \n\nNote: a)If it's Yes(There is a Business Communication and it's a legit)\nb) If it's No (There is no Business Communication). \n\n\nValidate Sender address  is a legit?: {0}\n\nValidate Recipient address  is a legit?:{1}\n\nopco:{2}\n"
                            }
                        },
                        "requiredParameters": [
                            {
                                "data_type": "string",
                                "field": "id"
                            },
                            {
                                "data_type": "string",
                                "field": "work_note"
                            },
                            {
                                "data_type": "string",
                                "default": "incident",
                                "field": "table_name"
                            }
                        ],
                        "type": "action"
                    },
                    "errors": {},
                    "id": "23",
                    "type": "action",
                    "warnings": {},
                    "x": 160,
                    "y": 1260
                },
                "25": {
                    "data": {
                        "advanced": {
                            "join": []
                        },
                        "conditions": [
                            {
                                "comparisons": [
                                    {
                                        "conditionIndex": 0,
                                        "op": "!=",
                                        "param": "ip_reputation:action_result.status",
                                        "value": "None"
                                    },
                                    {
                                        "conditionIndex": 0,
                                        "op": "!=",
                                        "param": "file_reputation:action_result.status",
                                        "value": "None"
                                    }
                                ],
                                "conditionIndex": 0,
                                "customName": "Data Enriched",
                                "display": "If",
                                "logic": "or",
                                "type": "if"
                            }
                        ],
                        "functionId": 1,
                        "functionName": "decision_1",
                        "id": "25",
                        "type": "decision"
                    },
                    "errors": {},
                    "id": "25",
                    "type": "decision",
                    "warnings": {},
                    "x": 250,
                    "y": 772
                },
                "26": {
                    "data": {
                        "action": "add work note",
                        "actionType": "generic",
                        "advanced": {
                            "join": []
                        },
                        "connector": "ServiceNow",
                        "connectorConfigs": [
                            "servicenowprod"
                        ],
                        "connectorId": "a590c3bc-ca41-4a0e-b063-8066ca868794",
                        "connectorVersion": "v1",
                        "customDatapaths": {
                            "artifacts": {
                                "artifact:*.cef.Threat_MD5_hash": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.Threat_MD5_hash",
                                    "value": "artifact:*.cef.Threat_MD5_hash"
                                },
                                "artifact:*.cef.senderIP": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.senderIP",
                                    "value": "artifact:*.cef.senderIP"
                                }
                            },
                            "create_sir_ticket": {
                                "action_result.data.*.sys_target_sys_id.value": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "action_result.data.*.sys_target_sys_id.value",
                                    "value": "create_sir_ticket:action_result.data.*.sys_target_sys_id.value"
                                }
                            }
                        },
                        "functionId": 2,
                        "functionName": "add_work_note_2",
                        "id": "26",
                        "parameters": {
                            "id": "create_sir_ticket:action_result.data.*.sys_target_sys_id.value",
                            "is_sys_id": true,
                            "table_name": "sn_si_incident",
                            "work_note": {
                                "functionId": 2,
                                "parameters": [
                                    "artifact:*.cef.Threat_MD5_hash",
                                    "file_reputation:action_result.summary",
                                    "artifact:*.cef.senderIP",
                                    "ip_reputation:action_result.summary"
                                ],
                                "template": "Hi SOC Team,\n\nIP & Hash Reputation checks are done through RF automation and below are the details. Please look into it,\n\nThreat_MD5_hash:{0}\n\nHash Reputation Checks in RF:{1}\n\nSender IP:{2}\n\nSender IP Reputation Checks in RF:{3}\n\nThanks,\nSOAR Automation Team.\n"
                            }
                        },
                        "requiredParameters": [
                            {
                                "data_type": "string",
                                "field": "id"
                            },
                            {
                                "data_type": "string",
                                "field": "work_note"
                            },
                            {
                                "data_type": "string",
                                "default": "incident",
                                "field": "table_name"
                            }
                        ],
                        "type": "action"
                    },
                    "errors": {},
                    "id": "26",
                    "type": "action",
                    "warnings": {},
                    "x": 170,
                    "y": 624
                },
                "28": {
                    "data": {
                        "advanced": {
                            "join": []
                        },
                        "conditions": [
                            {
                                "comparisons": [
                                    {
                                        "conditionIndex": 0,
                                        "op": "==",
                                        "param": "sender_and_recipient_address_user_validation:action_result.summary.responses.0",
                                        "value": "No"
                                    },
                                    {
                                        "conditionIndex": 0,
                                        "op": "==",
                                        "param": "sender_and_recipient_address_user_validation:action_result.summary.responses.1",
                                        "value": "No"
                                    }
                                ],
                                "conditionIndex": 0,
                                "customName": "Sender_Rcpt_Validation_NO",
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "comparisons": [
                                    {
                                        "conditionIndex": 1,
                                        "op": "==",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "conditionIndex": 1,
                                "customName": "Sender_RCP_Validation_Yes",
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "functionId": 2,
                        "functionName": "decision_2",
                        "id": "28",
                        "type": "decision"
                    },
                    "errors": {},
                    "id": "28",
                    "type": "decision",
                    "warnings": {
                        "config": [
                            "Reconfigure invalid datapath."
                        ]
                    },
                    "x": 1160,
                    "y": 1380
                },
                "30": {
                    "data": {
                        "advanced": {
                            "customName": "Get_opco_details",
                            "customNameId": 0,
                            "join": [],
                            "notRequiredJoins": [
                                "worknote_update"
                            ]
                        },
                        "functionId": 2,
                        "functionName": "get_opco_details",
                        "id": "30",
                        "inputParameters": [
                            "artifact:*.cef.opco"
                        ],
                        "outputVariables": [
                            "header_out",
                            "url_out"
                        ],
                        "type": "code"
                    },
                    "errors": {},
                    "id": "30",
                    "type": "code",
                    "userCode": "\n    # Write your custom code here... \n    opco= container_artifact_cef_item_0[0]\n\n    opcos = {\n        'acr': {'header':\"'HYK6LYHLNHSETU7Z67PSS1CA/SM7V4WRVIF'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/795FW934/reputations/overrides'\"},\n        'asp': {'header':\"'I77WZ7USB22TZ978VA19HC12/L7YBFC3H6E'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/N33FQW65/reputations/overrides'\"},\n        'cen': {'header':\"'ZR6L53ZJCE4DTAQ5ZRNEVYZF/S3IQT7EI39'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/76DF3JW7/reputations/overrides'\"},\n        'frs': {'header':\"'UV3DH81SI3LRN3BSBUNJPRZV/RG359VB9KQ'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/N88FDK85/reputations/overrides'\"},\n        'tm':  {'header':\"'WP6K9RL49QWHBM2ZJSZ3U8S5/5ECMIRGMII'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/N2MFYJ2Z/reputations/overrides'\"},\n        'ftv': {'header':\"'WZ17RLJSDRINND3VU2RCIJ37/B6ZWJJDZ1N'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/N5DFVQ2Z/reputations/overrides'\"},\n        'gor': {'header':\"'K8741KZESG34K58HMVM1IBYI/RFJ6KI9Z4S'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/NKZFRP6W/reputations/overrides'\"},\n        'isc': {'header':\"'G92CFQ2WBZIUFWSZFFZFR7T1/QCDUICWKKJ'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/7L9FE36N/reputations/overrides'\"},\n        'inv': {'header':\"'2SNS9AIABEZ3DWP2A46VZPYN/V2WGZQ3F1C'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/NJZFD8ZX/reputations/overrides'\"},\n        'jan': {'header':\"'DYZ7S3AKJTYURFKB6LGJJMS1/CFZGRFJRN6'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/76DFRPV2/reputations/overrides'\"},\n        'ldr': {'header':\"'LDNKAWAR3Z1LLTEK9BVU1NZQ/3Z2619WN6C'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/7P9F3VEV/reputations/overrides'\"},\n        'pse': {'header':\"'R1NFRZJ3UWBGNR62WPFZ44I9/L87K9LHY8Q'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/N4LFP44N/reputations/overrides'\"},\n        'qtc': {'header':\"'7C3HIJEMKSMR8DDUZ498ICHN/CHZW3Z5JJA'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/N4LFY6J3/reputations/overrides'\"},\n        'sg':  {'header':\"'4URN17WSHMZ15EZ3IU6EAK7Z/QZY547AEI5'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/7RZFW8XX/reputations/overrides'\"},\n        'svc': {'header':\"'BSAB9C5ZEKR24I2FKGNB6ZAZ/JIS3ED89GB'\",'url':\"'https://defense-prod05.conferdeploy.net/appservices/v6/orgs/7Z2F2V22/reputations/overrides'\"}\n    }\n\n    def switch(opco):\n        header=opcos[opco]['header']\n        url=opcos[opco]['url']\n        return header, url\n    header, url = switch(opco)\n\n    get_opco_details__header_out=header\n    get_opco_details__url_out=url\n\n",
                    "warnings": {},
                    "x": -420,
                    "y": 1620
                },
                "31": {
                    "customCode": "@phantom.playbook_block()\ndef block_hash_custom_function(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug(\"block_hash_custom_function() called\")\n    import json\n    import phantom.requests\n    container_artifact_data = phantom.collect2(container=container, datapath=[\"artifact:*.cef.Threat_MD5_hash\"])\n    get_opco_details__header_out = json.loads(phantom.get_run_data(key=\"get_opco_details:header_out\"))\n    get_opco_details__url_out = json.loads(phantom.get_run_data(key=\"get_opco_details:url_out\"))\n\n    container_artifact_cef_item_0 = [item[0] for item in container_artifact_data]\n    container_artifact_cef_item_1 = [item[1] for item in container_artifact_data]\n\n    block_hash_custom_function__api_call_return = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n    Threat_MD5_hash=None\n    Threat_MD5_hash = container_artifact_cef_item_0[0]\n    file_name=container_artifact_cef_item_1[0]\n    get_opco_details__header_out=get_opco_details__header_out.strip(\"'\")    \n    headers1 = {\"X-Auth-Token\" : get_opco_details__header_out, \"content-type\": \"application/json\"}   \n    \n    url=get_opco_details__url_out.strip(\"'\")    \n    myobj = {\"description\": \"An blacklist override for a sha256 hash\",\"override_list\": \"BLACK_LIST\",\"override_type\": \"SHA256\",\"sha256_hash\": Threat_MD5_hash, \"filename\": file_name}\n    x = phantom.requests.post(url, data = json.dumps(myobj), headers=headers1)    \n    block_hash_custom_function__api_call_return = x.json()\n\n    ################################################################################\n    ## Custom Code End\n    \n    ################################################################################\n    phantom.save_run_data(key=\"block_hash_custom_function:api_call_return\", value=json.dumps(block_hash_custom_function__api_call_return))\n\n    result_summary(container=container)\n    \n    return",
                    "data": {
                        "advanced": {
                            "customName": "block_hash_custom_function",
                            "customNameId": 0,
                            "join": []
                        },
                        "functionId": 3,
                        "functionName": "block_hash_custom_function",
                        "id": "31",
                        "inputParameters": [],
                        "outputVariables": [],
                        "type": "code"
                    },
                    "errors": {},
                    "id": "31",
                    "type": "code",
                    "warnings": {},
                    "x": -420,
                    "y": 1800
                },
                "32": {
                    "customCode": "@phantom.playbook_block()\ndef result_summary(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug(\"result_summary() called\")\n\n    template = \"\"\"Hash value has been added to opco: {0}\\nAdded SHA256 hash value to banned list/blacklist: {1}\\nJSON response received {2}\\n\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"artifact:*.cef.opco\",\n        \"artifact:*.cef.Threat_MD5_hash\",\n        \"block_hash_custom_function:custom_function:api_call_return\"\n    ]\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"result_summary\")\n\n    return",
                    "data": {
                        "advanced": {
                            "customName": "result_summary",
                            "customNameId": 0,
                            "join": []
                        },
                        "functionId": 4,
                        "functionName": "result_summary",
                        "id": "32",
                        "parameters": [
                            ""
                        ],
                        "template": "{0}\n",
                        "type": "format"
                    },
                    "errors": {},
                    "id": "32",
                    "type": "format",
                    "warnings": {},
                    "x": -440,
                    "y": 1980
                },
                "34": {
                    "data": {
                        "advanced": {
                            "join": []
                        },
                        "functionId": 1,
                        "functionName": "playbook_Fortive:_CB_Block_Hash_v2_copy_1",
                        "id": "34",
                        "inputs": {},
                        "playbookName": "Fortive: CB_Block_Hash_v2_copy",
                        "playbookRepo": 2,
                        "playbookRepoName": "local",
                        "playbookType": "automation",
                        "synchronous": false,
                        "type": "playbook"
                    },
                    "errors": {},
                    "id": "34",
                    "type": "playbook",
                    "warnings": {},
                    "x": 160,
                    "y": 1600
                },
                "35": {
                    "data": {
                        "advanced": {
                            "customName": "hashout_url_out",
                            "customNameId": 0,
                            "join": []
                        },
                        "customDatapaths": {
                            "playbook": {
                                "launching_user.header_out": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "launching_user.header_out",
                                    "value": "playbook:launching_user.header_out"
                                },
                                "launching_user.url_out": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "launching_user.url_out",
                                    "value": "playbook:launching_user.url_out"
                                }
                            }
                        },
                        "functionId": 1,
                        "functionName": "hashout_url_out",
                        "id": "35",
                        "parameters": [
                            "playbook:launching_user.header_out",
                            "playbook:launching_user.url_out"
                        ],
                        "template": "Hi Team,\nPlease find the below details\n\nheader_out:{0}\nurl_out:{1}\n",
                        "type": "format"
                    },
                    "errors": {},
                    "id": "35",
                    "type": "format",
                    "warnings": {
                        "context": [
                            "Connect block to playbook flow."
                        ]
                    },
                    "x": 1160,
                    "y": 1760
                },
                "37": {
                    "data": {
                        "action": "send email",
                        "actionType": "generic",
                        "advanced": {
                            "join": []
                        },
                        "connector": "SMTP",
                        "connectorConfigs": [
                            "smtp_fqdn"
                        ],
                        "connectorId": "45bb6f37-4478-499b-b4a3-51ecfa62b78c",
                        "connectorVersion": "v1",
                        "functionId": 2,
                        "functionName": "send_email_2",
                        "id": "37",
                        "parameters": {
                            "body": "hashout_url_out:formatted_data",
                            "from": "no-reply@fortive.com",
                            "subject": "hash_out and URL_Out value",
                            "to": "sabarirajan.thangavel@ftvitservices.com"
                        },
                        "requiredParameters": [
                            {
                                "data_type": "string",
                                "field": "to"
                            },
                            {
                                "data_type": "string",
                                "field": "body"
                            }
                        ],
                        "type": "action"
                    },
                    "errors": {},
                    "id": "37",
                    "type": "action",
                    "warnings": {},
                    "x": 1160,
                    "y": 2020
                },
                "6": {
                    "data": {
                        "advanced": {
                            "join": []
                        },
                        "customFunction": {
                            "draftMode": false,
                            "name": "debug",
                            "repoName": "community"
                        },
                        "functionId": 1,
                        "functionName": "debug_1",
                        "id": "6",
                        "selectMore": false,
                        "type": "utility",
                        "utilities": {
                            "debug": {
                                "description": "Print debug messages with the type and value of 0-10 different inputs. This is useful for checking the values of input data or the outputs of other playbook blocks.",
                                "fields": [
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_1",
                                        "name": "input_1",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_2",
                                        "name": "input_2",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_3",
                                        "name": "input_3",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_4",
                                        "name": "input_4",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_5",
                                        "name": "input_5",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_6",
                                        "name": "input_6",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_7",
                                        "name": "input_7",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_8",
                                        "name": "input_8",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_9",
                                        "name": "input_9",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    },
                                    {
                                        "dataTypes": [
                                            "*"
                                        ],
                                        "description": "",
                                        "inputType": "list",
                                        "label": "input_10",
                                        "name": "input_10",
                                        "placeholder": "",
                                        "renderType": "datapath",
                                        "required": false
                                    }
                                ],
                                "label": "debug",
                                "name": "debug"
                            }
                        },
                        "utilityType": "custom_function",
                        "values": {
                            "debug": {
                                "input_1": [
                                    "file_reputation_1:action_result.summary"
                                ],
                                "input_10": null,
                                "input_2": [
                                    "ip_reputation_1:action_result.summary"
                                ],
                                "input_3": null,
                                "input_4": null,
                                "input_5": null,
                                "input_6": null,
                                "input_7": null,
                                "input_8": null,
                                "input_9": null
                            }
                        }
                    },
                    "errors": {},
                    "id": "6",
                    "type": "utility",
                    "warnings": {},
                    "x": 160,
                    "y": 1920
                },
                "8": {
                    "data": {
                        "action": "file reputation",
                        "actionType": "investigate",
                        "advanced": {
                            "customName": "file_reputation",
                            "customNameId": 0,
                            "join": []
                        },
                        "connector": "Recorded Future",
                        "connectorConfigs": [
                            "recorded_future"
                        ],
                        "connectorId": "6efe0e1b-76ac-4ffd-8fa0-ac58fd6efd77",
                        "connectorVersion": "v1",
                        "customDatapaths": {
                            "artifacts": {
                                "artifact:*.cef.Threat_MD5_hash": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.Threat_MD5_hash",
                                    "value": "artifact:*.cef.Threat_MD5_hash"
                                }
                            }
                        },
                        "functionId": 1,
                        "functionName": "file_reputation",
                        "id": "8",
                        "parameters": {
                            "hash": "artifact:*.cef.Threat_MD5_hash"
                        },
                        "requiredParameters": [
                            {
                                "data_type": "string",
                                "field": "hash"
                            }
                        ],
                        "type": "action"
                    },
                    "errors": {},
                    "id": "8",
                    "type": "action",
                    "warnings": {},
                    "x": 0,
                    "y": 476
                },
                "9": {
                    "data": {
                        "action": "ip reputation",
                        "actionType": "investigate",
                        "advanced": {
                            "customName": "ip_reputation",
                            "customNameId": 0,
                            "join": []
                        },
                        "connector": "Recorded Future",
                        "connectorConfigs": [
                            "recorded_future"
                        ],
                        "connectorId": "6efe0e1b-76ac-4ffd-8fa0-ac58fd6efd77",
                        "connectorVersion": "v1",
                        "customDatapaths": {
                            "artifacts": {
                                "artifact:*.cef.senderIP": {
                                    "contains": [],
                                    "isCustomDatapath": true,
                                    "label": "artifact:*.cef.senderIP",
                                    "value": "artifact:*.cef.senderIP"
                                }
                            }
                        },
                        "functionId": 1,
                        "functionName": "ip_reputation",
                        "id": "9",
                        "parameters": {
                            "ip": "artifact:*.cef.senderIP"
                        },
                        "requiredParameters": [
                            {
                                "data_type": "string",
                                "field": "ip"
                            }
                        ],
                        "type": "action"
                    },
                    "errors": {},
                    "id": "9",
                    "type": "action",
                    "warnings": {},
                    "x": 340,
                    "y": 476
                }
            },
            "notes": ""
        },
        "input_spec": null,
        "output_spec": null,
        "playbook_type": "automation",
        "python_version": "3",
        "schema": "5.0.10",
        "version": "6.1.0.131"
    },
    "create_time": "2023-09-27T14:19:13.103028+00:00",
    "draft_mode": false,
    "labels": [
        "*"
    ],
    "tags": []
}